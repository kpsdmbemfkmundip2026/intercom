<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEBSITE INTERCOM BIDANG K&PSDM</title>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // Komponen Icon agar sama dengan desain kodingan asli kamu
        const LucideIcon = ({ name, className }) => {
            const [iconHtml, setIconHtml] = useState('');
            useEffect(() => {
                if (window.lucide) {
                    const icon = window.lucide.icons[name];
                    if (icon) {
                        const svg = window.lucide.createSvg(icon, { 
                            class: className,
                            'stroke-width': 2
                        });
                        setIconHtml(svg);
                    }
                }
            }, [name, className]);
            return <span className="inline-flex" dangerouslySetInnerHTML={{ __html: iconHtml }} />;
        };

        const App = () => {
            const [selectedPJ, setSelectedPJ] = useState('');
            const [selectedContact, setSelectedContact] = useState(null);
            const [timeOfDay, setTimeOfDay] = useState('pagi');
            const [message, setMessage] = useState('');
            const [copied, setCopied] = useState(false);
            const [searchTerm, setSearchTerm] = useState('');

            // Data kontak asli sesuai kodingan kamu
            const contactData = {
                'Evan': [
                    { unit: 'BEM FKM', phone: '082116796008', name: 'Fikhar', position: 'Ketua BEM FKM' },
                    { unit: 'HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '089539714502', name: 'Ilham', position: 'Ketua Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN PPI HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '08111286442', name: 'Jey', position: 'Ketua Departemen PPI Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN PI HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '082137753469', name: 'Farah', position: 'Ketua Departemen PI Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'PEMINATAN KESEHATAN LINGKUNGAN', phone: '081393409708', name: 'Maharani', position: 'Peminatan Kesehatan Lingkungan' },
                    { unit: 'BIRO KMI BEM FKM', phone: '08117671202', name: 'Alifah', position: 'Ketua Biro KMI BEM FKM' },
                    { unit: 'BIDANG K&PENGMAS BEM FKM', phone: '08112618995', name: 'Deny', position: 'Ketua Bidang K&PENGMAS BEM FKM' }
                ],
                'Jeo': [
                    { unit: 'PSM FKM', phone: '08121411801', name: 'Karen', position: 'PSM FKM' },
                    { unit: 'DEPARTEMEN KEILMUAN HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '085769569991', name: 'Syakira', position: 'Ketua Departemen Keilmuan Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN MEDINFO HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '081325740363', name: 'Fibri', position: 'Ketua Departemen Medinfo Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'PEMINATAN K3', phone: '087722460391', name: 'Husain', position: 'Peminatan K3' },
                    { unit: 'BIRO ADMIN BEM FKM', phone: '081332334398', name: 'Milda', position: 'Ketua Biro Admin BEM FKM' },
                    { unit: 'BIDANG MIKAT BEM FKM', phone: '088215109680', name: 'Jihan', position: 'Ketua Bidang MIKAT BEM FKM' }
                ],
                'Lily': [
                    { unit: 'PIRC', phone: '089536334701', name: 'Amanda', position: 'PIRC' },
                    { unit: 'SPORTYCA', phone: '085212367554', name: 'Cornelia', position: 'Sportyca' },
                    { unit: 'DEPARTEMEN KEMAHASISWAAN HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '087738831766', name: 'Kinan', position: 'Ketua Departemen Kemahasiswaan Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN PSDM HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '081390240726', name: 'Shifa', position: 'Ketua Departemen PSDM Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'PEMINATAN EPIDEMIOLOGI', phone: '089521897115', name: 'Salwa Audrie', position: 'Peminatan Epidemiologi' },
                    { unit: 'PEMINATAN ENTOMOLOGI', phone: '085718921051', name: 'Surya Natanegara', position: 'Peminatan Entomologi' },
                    { unit: 'BIDANG RISKEL BEM FKM', phone: '085877335371', name: 'Maulida', position: 'Ketua Bidang RISKEL BEM FKM' },
                    { unit: 'BIDANG EKOTIF BEM FKM', phone: '089669129858', name: 'Darin', position: 'Ketua Bidang EKOTIF BEM FKM' }
                ],
                'Wawa': [
                    { unit: 'SENAT MAHASISWA FKM', phone: '082110063943', name: 'Naila', position: 'Senat Mahasiswa FKM' },
                    { unit: 'DEPARTEMEN PSDM HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '087782951049', name: 'Arina', position: 'Ketua Departemen PSDM Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN TIPEMU HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '085271024742', name: 'Ruth', position: 'Ketua Departemen TIPEMU Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'PEMINATAN PKIP', phone: '087839475453', name: 'Rayung', position: 'Peminatan PKIP' },
                    { unit: 'KOMTING 2025', phone: '081918481223', name: 'Ghifari', position: 'Komting 2025' },
                    { unit: 'BIDANG SOSPOL BEM FKM', phone: '087885156165', name: 'Ghani', position: 'Ketua Bidang SOSPOL BEM FKM' },
                    { unit: 'BIDANG HARKAM BEM FKM', phone: '082134809481', name: 'Daffa', position: 'Ketua Bidang HARKAM BEM FKM' }
                ],
                'Aru': [
                    { unit: 'STOPHIVA', phone: '085225414582', name: 'Nurul Izzah', position: 'StopHIVa' },
                    { unit: 'STUDIO8', phone: '087889808483', name: 'Sera', position: 'Studio8' },
                    { unit: 'DEPARTEMEN KMI HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '085712724984', name: 'Dita', position: 'Ketua Departemen KMI Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN PENGMAS HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '085210586748', name: 'Alma', position: 'Ketua Departemen Pengmas Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'PEMINATAN AKK', phone: '08113978978', name: 'Nazwa', position: 'Peminatan AKK' },
                    { unit: 'BIDANG KESTRA BEM FKM', phone: '081229801055', name: 'Bima', position: 'Ketua Bidang KESTRA BEM FKM' }
                ],
                'Faiza': [
                    { unit: 'HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '085884781730', name: 'Andi', position: 'Ketua Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'DEPARTEMEN SOSMAS HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '087810076394', name: 'Deswita', position: 'Ketua Departemen Sosmas Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN SENIORA HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '089601418488', name: 'Winda', position: 'Ketua Departemen Seniora Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'PEMINATAN GIZI KESEHATAN MASYARAKAT', phone: '085716738931', name: 'Syahfitri', position: 'Peminatan Gizi Kesehatan Masyarakat' },
                    { unit: 'BIDANG POKJA ISMKMI BEM FKM', phone: '081297220219', name: 'Mutia', position: 'Ketua Bidang POKJA ISMKMI BEM FKM' }
                ],
                'Ian': [
                    { unit: 'KSR', phone: '085727583052', name: 'Dinda', position: 'KSR' },
                    { unit: 'DEPARTEMEN SENIORA HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '081918431357', name: 'Talitha', position: 'Ketua Departemen Seni dan Olahraga Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN NOTIF HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '081932371915', name: 'Grinna', position: 'Ketua Departemen NOTIF Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'PEMINATAN BIOSTATISTIKA DAN KEPENDUDUKAN', phone: '088225234055', name: 'Taat Wigati', position: 'Peminatan Biostatistika dan Kependudukan' },
                    { unit: 'BIDANG CED BEM FKM', phone: '089980232596', name: 'Sulthon', position: 'Ketua Bidang CED BEM FKM' }
                ],
                'Kattari': [
                    { unit: 'DEPARTEMEN KEWIRAUSAHAAN HIMPUNAN MAHASISWA KESEHATAN MASYARAKAT', phone: '085713187074', name: 'Muna', position: 'Ketua Departemen Kewirausahaan Himpunan Mahasiswa Kesehatan Masyarakat' },
                    { unit: 'DEPARTEMEN PENWA HIMPUNAN MAHASISWA PROGRAM STUDI KESELAMATAN DAN KESEHATAN KERJA', phone: '082138316959', name: 'Zahirah', position: 'Ketua Departemen PENWA Himpunan Mahasiswa Program Studi Keselamatan dan Kesehatan Kerja' },
                    { unit: 'KOMTING 2023', phone: '085881797522', name: 'Grestine', position: 'Komting 2023' },
                    { unit: 'KOMTING 2024', phone: '085695572360', name: 'Andreas', position: 'Komting 2024' },
                    { unit: 'BIDANG KESMA BEM FKM', phone: '081228935025', name: 'Neibila', position: 'Ketua Bidang KESMA BEM FKM' }
                ]
            };

            const greetings = { pagi: 'pagi', siang: 'siang', sore: 'sore', malam: 'malam' };
            const currentContacts = selectedPJ ? contactData[selectedPJ] : [];

            const filteredContacts = useMemo(() => {
                if (!searchTerm) return currentContacts;
                return currentContacts.filter(contact =>
                    contact.unit.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    contact.name.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }, [currentContacts, searchTerm]);

            const generatedMessage = useMemo(() => {
                if (!selectedPJ || !selectedContact || !message) return '';
                return `Assalamualaikum Wr. Wb. Selamat ${greetings[timeOfDay]}, Kak ${selectedContact.name}. Mohon maaf mengganggu waktunya.\n\nPerkenalkan kembali saya ${selectedPJ} selaku Staf Muda Bidang K&PSDM BEM FKM UNDIP 2026 yang merupakan perwakilan Intercom Bidang K&PSDM BEM FKM UNDIP dengan ${selectedContact.unit}.\n\nMaksud dan tujuan saya menghubungi Kak ${selectedContact.name} selaku ${selectedContact.position} adalah untuk ${message}\n\nSekian informasi yang dapat saya sampaikan. Terima kasih atas perhatian, Kak ${selectedContact.name}. Mohon maaf apabila terdapat kesalahan dalam penggunaan kata.\n\nSelamat ${greetings[timeOfDay]}, Kak ${selectedContact.name}. Wassalamualaikum Wr. Wb.`;
            }, [selectedPJ, selectedContact, timeOfDay, message]);

            const formatPhoneNumber = (phone) => {
                const cleaned = phone.replace(/\D/g, '');
                return cleaned.startsWith('0') ? '62' + cleaned.substring(1) : cleaned;
            };

            const handleCopy = () => {
                navigator.clipboard.writeText(generatedMessage);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            const handleSendWhatsApp = () => {
                if (!selectedContact) return;
                const encodedMessage = encodeURIComponent(generatedMessage);
                const phoneNumber = formatPhoneNumber(selectedContact.phone);
                window.open(`https://wa.me/${phoneNumber}?text=${encodedMessage}`, '_blank');
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 relative overflow-x-hidden pb-10">
                    {/* Header */}
                    <div className="glass-header sticky top-0 z-50 backdrop-blur-2xl bg-white/60 border-b border-white/20 shadow-lg p-5">
                        <div className="max-w-7xl mx-auto flex items-center gap-5">
                            <img src="https://i.ibb.co/Q77x9w9/VdVjBHC.png" className="w-16 h-16 object-contain" />
                            <div>
                                <h1 className="text-xl md:text-3xl font-bold bg-gradient-to-r from-blue-600 to-pink-600 bg-clip-text text-transparent">
                                    WEBSITE INTERCOM BIDANG K&PSDM
                                </h1>
                                <p className="text-sm text-gray-700 font-semibold">BEM FKM UNDIP 2026 - KABINET ARUNIKA</p>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-4xl mx-auto px-6 py-10 space-y-6 relative z-10">
                        {/* Pilih Pengirim */}
                        <div className="bg-white/70 backdrop-blur-xl rounded-3xl p-6 border shadow-xl">
                            <h2 className="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                                <span className="w-2 h-2 rounded-full bg-blue-500"></span> Pilih Nama Pengirim
                            </h2>
                            <select 
                                value={selectedPJ}
                                onChange={(e) => { setSelectedPJ(e.target.value); setSelectedContact(null); }}
                                className="w-full p-4 rounded-2xl border-2 border-blue-100 outline-none focus:border-blue-500"
                            >
                                <option value="">-- Pilih Nama Kamu --</option>
                                {Object.keys(contactData).map(name => <option key={name} value={name}>{name}</option>)}
                            </select>
                        </div>

                        {selectedPJ && (
                            <div className="bg-white/70 backdrop-blur-xl rounded-3xl p-6 border shadow-xl">
                                <h2 className="text-lg font-bold text-gray-800 mb-4">Cari Kontak Penerima</h2>
                                <div className="relative mb-4">
                                    <input 
                                        type="text" 
                                        placeholder="Cari unit atau nama..."
                                        value={searchTerm}
                                        onChange={(e) => setSearchTerm(e.target.value)}
                                        className="w-full p-4 pl-12 rounded-2xl border-2 border-blue-100"
                                    />
                                    <div className="absolute left-4 top-4 opacity-50"><LucideIcon name="Search" className="w-5 h-5" /></div>
                                </div>
                                <div className="grid gap-3 max-h-64 overflow-y-auto pr-2">
                                    {filteredContacts.map((contact, idx) => (
                                        <button 
                                            key={idx}
                                            onClick={() => setSelectedContact(contact)}
                                            className={`p-4 rounded-2xl text-left border transition ${selectedContact === contact ? 'bg-blue-600 text-white' : 'bg-white/50 hover:bg-blue-50'}`}
                                        >
                                            <div className="font-bold text-sm uppercase">{contact.unit}</div>
                                            <div className="text-xs opacity-80">{contact.name}</div>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        )}

                        {selectedContact && (
                            <div className="bg-white/70 backdrop-blur-xl rounded-3xl p-6 border shadow-xl space-y-4">
                                <h2 className="text-lg font-bold text-gray-800">Detail Pesan</h2>
                                <div className="grid grid-cols-4 gap-2">
                                    {['pagi', 'siang', 'sore', 'malam'].map(t => (
                                        <button 
                                            key={t}
                                            onClick={() => setTimeOfDay(t)}
                                            className={`p-3 rounded-xl font-bold capitalize transition ${timeOfDay === t ? 'bg-blue-600 text-white' : 'bg-white border'}`}
                                        >
                                            {t}
                                        </button>
                                    ))}
                                </div>
                                <textarea 
                                    placeholder="Tulis maksud tujuan..."
                                    value={message}
                                    onChange={(e) => setMessage(e.target.value)}
                                    className="w-full h-32 p-4 rounded-2xl border-2 border-blue-100 outline-none"
                                />
                                
                                {generatedMessage && (
                                    <div className="space-y-4">
                                        <div className="p-4 bg-white/50 border rounded-2xl text-sm whitespace-pre-wrap leading-relaxed italic">
                                            {generatedMessage}
                                        </div>
                                        <div className="grid grid-cols-2 gap-4">
                                            <button onClick={handleCopy} className="p-4 rounded-2xl bg-slate-800 text-white font-bold flex items-center justify-center gap-2">
                                                <LucideIcon name={copied ? "Check" : "Copy"} className="w-5 h-5" /> {copied ? 'Tersalin' : 'Salin'}
                                            </button>
                                            <button onClick={handleSendWhatsApp} className="p-4 rounded-2xl bg-green-600 text-white font-bold flex items-center justify-center gap-2">
                                                <LucideIcon name="Send" className="w-5 h-5" /> Kirim WA
                                            </button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
